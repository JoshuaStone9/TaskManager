@{
    ViewData["Title"] = "Home";
}

<div class="welcome-section">
    <h2>Welcome to the Coffee Shop Task Manager</h2>
    <p>Manage tasks and track employee assignments</p>
</div>

@if (ViewBag.Error != null)
{
    <div class="error">
        <p>Error: @ViewBag.Error</p>
    </div>
}

<div class="section">
    <h3>All Task Assignments Overview</h3>
    <div class="task-grid">
        @if (ViewBag.Assignments != null)
        {
            @foreach (var assignment in ViewBag.Assignments)
            {
                var statusClass = assignment.Status.Replace(" ", "-").ToLower();
                
                <div class="task-card @statusClass">
                    <div class="task-header">
                        <h4>@assignment.Task.Title</h4>
                        <span class="status-badge @statusClass">@assignment.Status</span>
                    </div>
                    <div class="task-body">
                        <p class="assigned-to">
                            <strong>Assigned to:</strong> 
                            <a href="/Home/EmployeeTasks/@assignment.Employee.Id">@assignment.Employee.Name</a>
                        </p>
                        <div class="task-actions">
                            <form method="post" action="/Home/UpdateTaskStatus" style="display: inline;">
                                <input type="hidden" name="id" value="@assignment.Id" />
                                <input type="hidden" name="status" value="In Progress" />
                                <button type="submit" class="btn-small btn-warning">Start</button>
                            </form>
                            <form method="post" action="/Home/UpdateTaskStatus" style="display: inline;">
                                <input type="hidden" name="id" value="@assignment.Id" />
                                <input type="hidden" name="status" value="Completed" />
                                <button type="submit" class="btn-small btn-success">Complete</button>
                            </form>
                            <form method="post" action="/Home/UpdateTaskStatus" style="display: inline;">
                                <input type="hidden" name="id" value="@assignment.Id" />
                                <input type="hidden" name="status" value="Not Started" />
                                <button type="submit" class="btn-small btn-secondary">Reset</button>
                            </form>
                        </div>
                    </div>
                </div>
            }
        }
    </div>
</div>

<div class="section">
    <h3>Team Members</h3>
    <div class="employee-grid">
        @if (ViewBag.Employees != null && ViewBag.Assignments != null)
        {
            @foreach (var employee in ViewBag.Employees)
            {
                var taskCount = ((List<TaskManager.TaskAssignment>)ViewBag.Assignments).Count(a => a.EmployeeId == employee.Id);
                
                <div class="employee-card">
                    <div class="employee-icon"></div>
                    <h4>@employee.Name</h4>
                    <p class="employee-id">ID: @employee.Id</p>
                    <p class="task-count">@taskCount task(s) assigned</p>
                    <a href="/Home/EmployeeTasks/@employee.Id" class="btn">View Tasks</a>
                </div>
            }
        }
    </div>
</div>
